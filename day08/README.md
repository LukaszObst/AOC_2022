SQL Solution using [Exasols 7.1 SQL-Standard](https://docs.exasol.com/db/latest/sql_references/sqlstandardcompliance.htm). With a few changes this will run on Oracle as well.

![sol](./sql_sol.png)
